<?xml version="1.0" encoding="UTF-8"?>
<DecisionSupportServiceModule xmlns="http://hl7.org/fhir" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://hl7.org/fhir ../../schema/fhir-single.xsd">
	<!-- This example demonstrates the use of the KnowledgeModule structure to represent a CDS-Hooks Activity -->
	<id value="cms-price-check"/>
	<text>
		<status value="generated"/>
		<div xmlns="http://www.w3.org/1999/xhtml">CMS Price Check - CDS Hooks Example Activity</div>
	</text>

  <contained>
    <ModuleMetadata>
		<id value="cms-price-check-metadata"/>
		<identifier>
          <use value="official"/>
          <value value="cms-price-check"/>
		</identifier>
		<version value="1.0.0"/>
		<title value="CMS Price Check - CDS Hooks Example Activity"/>
		<type value="module"/>
		<status value="draft"/>
		<description value="This example demonstrates the use of the DecisionSupportServiceModule structure to represent a CDS-Hooks Activity."/>
		<publicationDate value="2016-10-02"/>
		<topic>
			<text value="CMS Price Check"/>
		</topic>
		<keyword value="CMS Price Check"/>
    </ModuleMetadata>
  </contained>
  
	<!-- Trigger -->
	<!-- TODO: DecisionSupportServiceModule should be able to describe it's triggers... -->
	<extension url="http://hl7.org/fhir/StructureDefinition/cqif-basic-guidance-trigger">
		<extension url="http://hl7.org/fhir/StructureDefinition/cqif-basic-guidance-trigger#type">
			<valueCode value="named-event"/>
		</extension>
		<extension url="http://hl7.org/fhir/StructureDefinition/cqif-basic-guidance-trigger#eventName">
			<valueString value="medication-prescribe"/>
		</extension>
	</extension>

	<!-- Identifier -->
	<identifier>
		<use value="official"/>
		<value value="cms-price-check"/>
	</identifier>
	<version value="1.0.0"/>
	
	<moduleMetadata>
		<reference value="#cms-price-check-metadata"/>
	</moduleMetadata>

	<!-- TODO: Define these on the $evaluate operation directly -->
	<!-- TODO: Add cardinality to the parameter definitions in DecisionSupportServiceModule -->
	<parameter>
		<name value="user"/>
		<use value="in"/>
		<type value="String"/>
	</parameter>
	
	<parameter>
		<name value="patient"/>
		<use value="in"/>
		<type value="Id"/>
	</parameter>
	
	<parameter>
		<name value="encounter"/>
		<use value="in"/>
		<type value="Id"/>
	</parameter>
	
	<!-- MedicationOrder Data Requirement -->
	<parameter>
		<name value="inputResource"/>
		<use value="in"/>
		<type value="MedicationOrder"/>
	</parameter>
	
</DecisionSupportServiceModule>

